.row
  .span3
    .row
      .span3
        %h4.bottom-margin-1 Listado de reportes detallados generados
        = will_paginate @reports
        %ul#detailed_reports.unstyled.well
          -@reports.each do |report|
            %li
              =link_to report.csv_file.file.identifier, report.csv_file_url
            %li
              =link_to report.pdf_file.file.identifier, report.pdf_file_url
        = will_paginate @reports
  .span9
    .row
      .span9#report_detailed_filter
        = search_form_for [:admin,@search], :url => admin_reports_detailed_path, :html=>{ :class=>'form-horizontal top-margin-1 filter' } do |f|
          %fieldset
            %legend Filtro
            .alert
              %strong Advertencia
              No olvide crear un filtro antes de Generar el reporte
            .control-group
              =f.text_field :user_first_name_cont, :class=> 'input-medium ', :placeholder=>'Nombre del agente'
              =f.text_field :user_last_name_cont, :class=> 'input-medium ', :placeholder=>'Apellido del agente'
              =f.text_field :user_idnumber_cont, :class=> 'input-medium ', :placeholder=>'Cédula del agente'
            .control-group
              =f.text_field :created_at_gteq, :class=> 'input-medium ', :placeholder=>'Creado después de '
              =f.text_field :created_at_lteq, :class=> 'input-medium ', :placeholder=>'Creado antes de '
            .form-actions
              =f.submit 'Filtrar', :name=>nil, :class=> 'btn btn-primary'
              %a.btn#report_clear_search{ href: "#{admin_reports_detailed_path}"} Limpiar
        
        =link_to 'Generar reporte', admin_reports_detailed_path, method: :post, class: 'btn bottom-margin-1'
    .row
      .span9
        %h4 Proeba de Filtro
        %hr
        %table.table.table-striped.table-bordered.table-condensed
          %thead
            %th No. Orden
            %th Tienda
            %th Nuevo cliente
            %th Cliente
            %th Fecha
            %th Modo de servicio
            %th Agente
            %th Tiempo de toma
            %th Monto de la order
            %th Pago efectivo
            %th Tipo de factura
            %th Estado en pulse
          %tbody
            -@carts.each do |cart|          
              %tr{:data=>{'cart-id'=> cart.id}, :id=>dom_id(cart)}
                %td= cart.id
                %td= cart.store.name
                %td= (cart.client && cart.client.carts.count == 1) ? '*' : ''
                %td= "#{cart.client.first_name} #{cart.client.last_name} - #{cart.client.last_phone.number.gsub(/([0-9]{3})([0-9]{3})([0-9]{4})/,'\\1-\\2-\\3')}"
                %td= cart.complete_on.strftime('%Y-%m-%d %H:%M:%S')
                %td= cart.service_method
                %td= number_to_cedula cart.user.idnumber
                %td= cart.take_time
                %td= number_to_currency cart.payment_amount
                %td= cart.try(:payment_type)
                %td= cart.try(:fiscal_type)
                %td= cart.try(:order_progress)