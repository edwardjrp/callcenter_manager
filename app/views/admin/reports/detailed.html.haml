= render 'reports'
.row
  .span4
    .row
      .span4
        %h4.bottom-margin-1 Listado de reportes detallados generados
        = will_paginate @reports
        %ul#detailed_reports.unstyled.well
          -@reports.each do |report|
            - unless report.pdf_file.file.nil?
              %li
                =link_to report.csv_file.file.identifier, report.csv_file_url
              %li
                =link_to report.pdf_file.file.identifier, report.pdf_file_url
        = will_paginate @reports
  .span8
    .row
      .span8#report_detailed_filter
        = search_form_for [:admin,@search], :url => admin_reports_detailed_path, :html=>{ :class=>'form-horizontal top-margin-1 filter' } do |f|
          %fieldset
            %legend Filtro
            .alert
              %strong Advertencia
              No olvide crear un filtro antes de Generar el reporte
            .control-group
              =f.text_field :user_first_name_cont, :class=> 'input-medium ', :placeholder=>'Nombre del agente'
              =f.text_field :user_last_name_cont, :class=> 'input-medium ', :placeholder=>'Apellido del agente'
              =f.text_field :user_idnumber_cont, :class=> 'input-medium ', :placeholder=>'Cédula del agente'
            .control-group
              =f.text_field :complete_on_gteq, :class=> 'input-medium datepicker', :placeholder=>'Completado después de '
              =f.text_field :complete_on_lteq, :class=> 'input-medium datepicker', :placeholder=>'Completado antes de '
            .form-actions
              =f.submit 'Filtrar', :name=>nil, :class=> 'btn btn-primary'
              %a.btn#report_clear_search{ href: "#{admin_reports_detailed_path}"} Limpiar
        
        =link_to 'Generar reporte', admin_reports_detailed_path(params: params), method: :post, class: 'btn bottom-margin-1'
    .row
      .span8
        %h4 Proeba de Filtro
        %hr
        %table.table.table-striped.table-bordered.table-condensed
          %thead
            %th No. Orden
            %th Tienda
            %th Nuevo cliente
            %th Cliente
            %th Fecha
            %th Modo de servicio
            %th Agente
            %th Monto de la order
            %th Estado en pulse
          %tbody
            -@carts.each do |cart|          
              %tr{:data=>{'cart-id'=> cart.id}, :id=>dom_id(cart)}
                %td= cart.id
                %td= cart.store.name
                %td= (cart.client && cart.client.carts.count == 1) ? '*' : ''
                %td= cart.client.full_name
                %td= cart.completion_info
                %td= cart.service_method
                %td= number_to_cedula cart.user.idnumber
                %td= number_to_currency cart.payment_amount
                %td= cart.try(:order_progress)